<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Wrapper for Python Keras Models — explain_keras • DALEXtra</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- dalexverse --><link href="../dalexverse.css" rel="stylesheet"><link href="../dalexverse-2.css" rel="stylesheet"><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Wrapper for Python Keras Models — explain_keras"><meta property="og:description" content="Keras models may be loaded into R environment like any other Python object. This function helps to inspect performance of Python model
and compare it with other models, using R tools like DALEX. This function creates an object that is easily accessible R version of Keras model
exported from Python via pickle file."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- google analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-5650686-14"></script><script>
 window.dataLayer = window.dataLayer || [];
 function gtag(){dataLayer.push(arguments);}
 gtag('js', new Date());

 gtag('config', 'UA-5650686-14');
</script></head><body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="../index.html">DALEXtra</a>
        <div class="info">
          <span class="partof">part of the <a href="https://github.com/ModelOriented/DrWhy" class="external-link">DrWhy.AI</a>
           developed by the <a href="https://mi2.mini.pw.edu.pl/" class="external-link">MI^2 DataLab</a> </span>
          <span class="version version-default">2.2.1</span>
        </div>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
        <li>
  <a href="https://github.com/ModelOriented/DALEXtra/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Wrapper for Python Keras Models</h1>
    <small class="dont-index">Source: <a href="https://github.com/ModelOriented/DALEXtra/blob/HEAD/R/explain_keras.R" class="external-link"><code>R/explain_keras.R</code></a></small>
    <div class="hidden name"><code>explain_keras.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Keras models may be loaded into R environment like any other Python object. This function helps to inspect performance of Python model
and compare it with other models, using R tools like DALEX. This function creates an object that is easily accessible R version of Keras model
exported from Python via pickle file.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">explain_keras</span><span class="op">(</span>
  <span class="va">path</span>,
  yml <span class="op">=</span> <span class="cn">NULL</span>,
  condaenv <span class="op">=</span> <span class="cn">NULL</span>,
  env <span class="op">=</span> <span class="cn">NULL</span>,
  data <span class="op">=</span> <span class="cn">NULL</span>,
  y <span class="op">=</span> <span class="cn">NULL</span>,
  weights <span class="op">=</span> <span class="cn">NULL</span>,
  predict_function <span class="op">=</span> <span class="cn">NULL</span>,
  predict_function_target_column <span class="op">=</span> <span class="cn">NULL</span>,
  residual_function <span class="op">=</span> <span class="cn">NULL</span>,
  <span class="va">...</span>,
  label <span class="op">=</span> <span class="cn">NULL</span>,
  verbose <span class="op">=</span> <span class="cn">TRUE</span>,
  precalculate <span class="op">=</span> <span class="cn">TRUE</span>,
  colorize <span class="op">=</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/Logic.html" class="external-link">isTRUE</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"knitr.in.progress"</span><span class="op">)</span><span class="op">)</span>,
  model_info <span class="op">=</span> <span class="cn">NULL</span>,
  type <span class="op">=</span> <span class="cn">NULL</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>path</dt>
<dd><p>a path to the pickle file. Can be used without other arguments if you are sure that active Python version match pickle version.</p></dd>
<dt>yml</dt>
<dd><p>a path to the yml file. Conda virtual env will be recreated from this file. If OS is Windows conda has to be added to the PATH first</p></dd>
<dt>condaenv</dt>
<dd><p>If yml param is provided, a path to the main conda folder. If yml is null, a name of existing conda environment.</p></dd>
<dt>env</dt>
<dd><p>A path to python virtual environment.</p></dd>
<dt>data</dt>
<dd><p>data.frame or matrix - data which will be used to calculate the explanations. If not provided, then it will be extracted from the model. Data should be passed without a target column (this shall be provided as the <code>y</code> argument). NOTE: If the target variable is present in the <code>data</code>, some of the functionalities may not work properly.</p></dd>
<dt>y</dt>
<dd><p>numeric vector with outputs/scores. If provided, then it shall have the same size as <code>data</code></p></dd>
<dt>weights</dt>
<dd><p>numeric vector with sampling weights. By default it's <code>NULL</code>. If provided, then it shall have the same length as <code>data</code></p></dd>
<dt>predict_function</dt>
<dd><p>function that takes two arguments: model and new data and returns a numeric vector with predictions.   By default it is <code>yhat</code>.</p></dd>
<dt>predict_function_target_column</dt>
<dd><p>Character or numeric containing either column name or column number in the model prediction object of the class that should be considered as positive (i.e. the class that is associated with probability 1). If NULL, the second column of the output will be taken for binary classification. For a multiclass classification setting, that parameter cause switch to binary classification mode with one vs others probabilities.</p></dd>
<dt>residual_function</dt>
<dd><p>function that takes four arguments: model, data, target vector y and predict function (optionally). It should return a numeric vector with model residuals for given data. If not provided, response residuals (\(y-\hat{y}\)) are calculated. By default it is <code>residual_function_default</code>.</p></dd>
<dt>...</dt>
<dd><p>other parameters</p></dd>
<dt>label</dt>
<dd><p>character - the name of the model. By default it's extracted from the 'class' attribute of the model</p></dd>
<dt>verbose</dt>
<dd><p>logical. If TRUE (default) then diagnostic messages will be printed</p></dd>
<dt>precalculate</dt>
<dd><p>logical. If TRUE (default) then <code>predicted_values</code> and <code>residual</code> are calculated when explainer is created.
This will happen also if <code>verbose</code> is TRUE. Set both <code>verbose</code> and <code>precalculate</code> to FALSE to omit calculations.</p></dd>
<dt>colorize</dt>
<dd><p>logical. If TRUE (default) then <code>WARNINGS</code>, <code>ERRORS</code> and <code>NOTES</code> are colorized. Will work only in the R console. Now by default it is <code>FALSE</code> while knitting and <code>TRUE</code> otherwise.</p></dd>
<dt>model_info</dt>
<dd><p>a named list (<code>package</code>, <code>version</code>, <code>type</code>) containing information about model. If <code>NULL</code>, <code>DALEX</code> will seek for information on it's own.</p></dd>
<dt>type</dt>
<dd><p>type of a model, either <code>classification</code> or <code>regression</code>. If not specified then <code>type</code> will be extracted from <code>model_info</code>.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>An object of the class 'explainer'.
<b>Example of Python code available at documentation <code><a href="explain_scikitlearn.html">explain_scikitlearn</a></code></b><br><b>Errors use case</b><br>Here is shortened version of solution for specific errors <br><br><b>There already exists environment with a name specified by given .yml file</b><br>If you provide .yml file that in its header contains name exact to name of environment that already exists, existing will be set active without changing it. <br>You have two ways of solving that issue. Both connected with anaconda prompt. First is removing conda env with command: <br><code>conda env remove --name myenv</code><br>And execute function once again. Second is updating env via: <br><code>conda env create -f environment.yml</code><br><br><b>Conda cannot find specified packages at channels you have provided.</b><br>That error may be caused by a lot of things. One of those is that specified version is too old to be available from the official conda repo.
Edit Your .yml file and add link to proper repository at channels section.<br><br>Issue may be also connected with the platform. If model was created on the platform with different OS yo may need to remove specific version from .yml file.<br><code>- numpy=1.16.4=py36h19fb1c0_0</code><br><code>- numpy-base=1.16.4=py36hc3f5095_0</code><br>In the example above You have to remove <code>=py36h19fb1c0_0</code> and <code>=py36hc3f5095_0</code><br>If some packages are not available for anaconda at all, use pip statement<br><br>If .yml file seems not to work, virtual env can be created manually using anaconda promt. <br><code>conda create -n name_of_env python=3.4</code><br><code>conda install -n name_of_env name_of_package=0.20</code><br></p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Szymon Maksymiuk</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://ModelOriented.github.io/DALEXtra/" class="external-link">"DALEXtra"</a></span><span class="op">)</span></span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.info.html" class="external-link">Sys.info</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="st">"sysname"</span><span class="op">]</span> <span class="op">!=</span> <span class="st">"Darwin"</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in">   <span class="co"># Explainer build (Keep in mind that 9th column is target)</span></span>
<span class="r-in">   <span class="fu"><a href="create_env.html">create_env</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"testing_environment.yml"</span>, package <span class="op">=</span> <span class="st">"DALEXtra"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in">   <span class="va">test_data</span> <span class="op">&lt;-</span></span>
<span class="r-in">   <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span></span>
<span class="r-in">   <span class="st">"https://raw.githubusercontent.com/jbrownlee/Datasets/master/pima-indians-diabetes.data.csv"</span>,</span>
<span class="r-in">   sep <span class="op">=</span> <span class="st">","</span><span class="op">)</span></span>
<span class="r-in">   <span class="co"># Keep in mind that when pickle is being built and loaded,</span></span>
<span class="r-in">   <span class="co"># not only Python version but libraries versions has to match aswell</span></span>
<span class="r-in">   <span class="va">explainer</span> <span class="op">&lt;-</span> <span class="fu">explain_keras</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"keras.pkl"</span>, package <span class="op">=</span> <span class="st">"DALEXtra"</span><span class="op">)</span>,</span>
<span class="r-in">   condaenv <span class="op">=</span> <span class="st">"myenv"</span>,</span>
<span class="r-in">   data <span class="op">=</span> <span class="va">test_data</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">test_data</span><span class="op">[</span>,<span class="fl">9</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-in">   <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://modeloriented.github.io/DALEX/reference/model_performance.html" class="external-link">model_performance</a></span><span class="op">(</span><span class="va">explainer</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in">   <span class="co"># Predictions with newdata</span></span>
<span class="r-in">   <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">explainer</span>, <span class="va">test_data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p>Developed by .</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>.</p>
</div>

      </footer></div>

  


  </body></html>

